webpackJsonp([10],{CY0f:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("Dd8w"),r=n.n(o),a=n("7+uW"),u={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var s=n("VU/8")({name:"App"},u,!1,function(e){n("CY0f")},null,null).exports,i=n("/ocq"),l=n("//Fk"),c=n.n(l),d=n("NYxO"),f=n("mtWM"),p=n.n(f);n("Ya8g");function m(e,t){return!t.meta||!t.meta.role||e.some(function(e){return t.meta.role.indexOf(e)>=0})}a.default.use(d.a);var h={token:"",routers:v,addRouters:[],uid:"",userInfo:"",id:"",psw:""},g={GenerateRoutes:function(e,t){var n=e.commit;return new c.a(function(e){var o=t.roles,r=_.filter(function(e){return!!m(o,e)&&(e.children&&e.children.length>0?(e.children=e.children.filter(function(e){return!!m(o,e)&&e}),e):e)});n("SET_ROUTERS",r),e()})},GetUserInfo:function(e){var t=e.commit;return new c.a(function(e,n){var o={uid:sessionStorage.getItem("uid"),token:sessionStorage.getItem("token")};p.a.post("/api/aduser",o).then(function(n){t("SET_USERINFO",n.data),e(n.data)},function(e){n(e)})})}},b={SET_ROUTERS:function(e,t){e.addRouters=t,e.routers=v.concat(t),console.log(e.routers)},SET_USERINFO:function(e,t){e.userInfo=t},SET_TOKEN:function(e,t){e.token=t},SET_UID:function(e,t){e.uid=t}},k=new d.a.Store({state:h,actions:g,getters:{addRou:function(e){return e.addRouters},userInfo:function(e){return e.userInfo},id:function(e){return e.id}},mutations:b});a.default.use(i.a);var v=[{path:"/login",name:"登录页面",component:function(){return n.e(3).then(n.bind(null,"6Qob"))}},{path:"/404",name:"登录页面",component:function(){return n.e(1).then(n.bind(null,"wYVa"))}}],R=new i.a({routes:v}),_=[{path:"/home",name:"Home",component:function(){return n.e(2).then(n.bind(null,"/5L7"))},meta:{role:["admin","staff"]},children:[{path:"",name:"首页",component:function(){return n.e(0).then(n.bind(null,"FNcP"))},meta:{role:["admin","staff","super_editor"],title:"首页"}},{path:"/user",name:"用户列表",meta:{role:["admin","staff","super_editor"],title:"用户列表"},component:function(){return n.e(6).then(n.bind(null,"eJSA"))},titles:{title:"用户列表"}},{path:"/order",name:"订单列表",component:function(){return n.e(5).then(n.bind(null,"H6RF"))},meta:{role:["admin","staff","super_editor"],title:"订单列表"}},{path:"/banner",name:"广告信息",component:function(){return n.e(8).then(n.bind(null,"l6tK"))},meta:{role:["admin","super_editor"],title:"广告信息"}},{path:"/adminUser",name:"用户列表",component:function(){return n.e(7).then(n.bind(null,"Tkot"))},meta:{role:["admin","super_editor"],title:"用户列表"}},{path:"/addAdminUser",name:"新增用户",component:function(){return n.e(4).then(n.bind(null,"DCq2"))},meta:{role:["admin","super_editor"],title:"新增用户"}}]},{path:"*",redirect:"/404",hidden:!0}],I=n("mvHQ"),S=n.n(I);p.a.defaults.timeout=5e3,p.a.interceptors.request.use(function(e){return e.data=S()(e.data),e.headers={"Content-Type":"application/json; charset=utf-8",token:sessionStorage.getItem("token")},e},function(e){return c.a.reject(err)}),p.a.interceptors.response.use(function(e){return e},function(e){if(e&&e.response)switch(e.response.status){case 400:console.log("错误请求");break;case 401:console.log("未授权，请重新登录");break;case 403:console.log("拒绝访问");break;case 404:console.log("请求错误,未找到该资源");break;case 405:console.log("请求方法未允许");break;case 408:console.log("请求超时");break;case 500:console.log("服务器端出错");break;case 501:console.log("网络未实现");break;case 502:console.log("网络错误");break;case 503:console.log("服务不可用");break;case 504:console.log("网络超时");break;case 505:console.log("http版本不支持该请求");break;default:console.log("连接错误"+e.response.status)}else console.log("连接到服务器失败");return c.a.resolve(e.response)});var U={post:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new c.a(function(n,o){p.a.post(e,t).then(function(e){n(e.data)},function(e){o(e)})})}},w={login:"/login",order_all:"/order/all/ready",user_all:"/users",project:"/order/update/project",done:"/order/update/done",aduser:"/aduser",getAllUser:"/aduser/all/user",deleteUser:"/aduser/delete/user",updateUser:"/aduser/update/user",addUser:"/aduser/add/user"},E=n("zL8q"),T=n.n(E),O=n("XLwt"),y=n.n(O),N=n("mw3O"),A=n.n(N),F=(n("tvR6"),n("Y81h")),Y=n.n(F);n("UVIz");a.default.use(T.a),a.default.prototype.$http=U,a.default.prototype.$echarts=y.a,a.default.prototype.$common=w,a.default.prototype.$qs=A.a,a.default.config.productionTip=!1;var j=["/login"];R.beforeEach(function(e,t,n){sessionStorage.getItem("token")?"/login"===e.path?(console.log(1),n({path:"/"})):""==k.getters.userInfo?k.dispatch("GetUserInfo").then(function(t){var o=t.roles.split(",");k.dispatch("GenerateRoutes",{roles:o}).then(function(){console.log("addrouters",k.getters.addRou),R.addRoutes(k.getters.addRou),n(r()({},e,{replace:!0}))})}):(Y.a.start(),n()):-1!==j.indexOf(e.path)?n():n("/login")}),R.afterEach(function(e){Y.a.done()}),new a.default({el:"#app",router:R,store:k,components:{App:s},template:"<App/>"})},UVIz:function(e,t){},tvR6:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.d66312b8e474689706a2.js.map